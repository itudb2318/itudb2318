import pandas as pd
import mysql.connector
from os import listdir
from os.path import isfile, join

# MySQL connection configuration
database_config = {
    'user': 'root',
    'host': 'localhost',
    'password': '',
    'database': 'banking'
}

# Folder containing CSV files
csv_folder_path = 'banking_systems/'

# List all CSV files in the folder
csv_files = [f for f in listdir(csv_folder_path) if isfile(join(csv_folder_path, f)) and f.endswith('.csv')]

# Connect to MySQL database
connection = mysql.connector.connect(**database_config)
cursor = connection.cursor()

# Read each CSV file and write to MySQL table
for csv_file in csv_files:
    file_path = join(csv_folder_path, csv_file)
    df = pd.read_csv(file_path)
    table_name = f"mysql_table_{csv_file[:-4]}" # Remove the file extension and create the table name

     # Write the DataFrame to the MySQL table
    df.to_sql(name=table_name, con=connection, if_exists='replace', index=False)

# Close the connection
connection.close()


